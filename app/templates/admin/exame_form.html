{% extends "admin/base.html" %}

{% block title %}{{ title }} - Help Alpha Admin{% endblock %}
{% block page_title %}{{ title }}{% endblock %}

{% block content %}
<div class="columns is-centered">
    <div class="column is-8">
        <div class="card">
            <header class="card-header">
                <p class="card-header-title">
                    <span class="icon">
                        <i class="fas fa-edit"></i>
                    </span>
                    <span>{{ title }}</span>
                </p>
            </header>
            <div class="card-content">
                <form method="POST">
                    {{ form.hidden_tag() }}
                    
                    <div class="columns">
                        <div class="column is-6">
                            <div class="field">
                                <label class="label">{{ form.nome.label }}</label>
                                <div class="control">
                                    {{ form.nome(class="input", placeholder="Ex: Hemograma Completo") }}
                                </div>
                                {% if form.nome.errors %}
                                    {% for error in form.nome.errors %}
                                        <p class="help is-danger">{{ error }}</p>
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="column is-6">
                            <div class="field">
                                <label class="label">{{ form.tempo.label }}</label>
                                <div class="control">
                                    {{ form.tempo(class="input", placeholder="Ex: 10-15 minutos") }}
                                </div>
                                {% if form.tempo.errors %}
                                    {% for error in form.tempo.errors %}
                                        <p class="help is-danger">{{ error }}</p>
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="field">
                        <label class="label">{{ form.descricao.label }}</label>
                        <div class="control">
                            {{ form.descricao(class="textarea", placeholder="Descreva detalhadamente o que é o exame e para que serve...", rows=4) }}
                        </div>
                        {% if form.descricao.errors %}
                            {% for error in form.descricao.errors %}
                                <p class="help is-danger">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                        <p class="help">Descreva o exame de forma clara e compreensível para os pacientes.</p>
                    </div>
                    
                    <div class="field">
                        <label class="label">{{ form.preparo.label }}</label>
                        <div class="control">
                            {{ form.preparo(class="textarea", placeholder="Ex: Jejum de 8 horas. Evitar exercícios físicos 24h antes...", rows=3) }}
                        </div>
                        {% if form.preparo.errors %}
                            {% for error in form.preparo.errors %}
                                <p class="help is-danger">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                        <p class="help">Instruções específicas que o paciente deve seguir antes do exame.</p>
                    </div>
                    
                    <div class="field">
                        <label class="label">{{ form.documentos.label }}</label>
                        <div class="control">
                            {{ form.documentos(class="textarea", placeholder="Ex: RG, CPF, pedido médico e carteira do convênio", rows=2) }}
                        </div>
                        {% if form.documentos.errors %}
                            {% for error in form.documentos.errors %}
                                <p class="help is-danger">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                        <p class="help">Liste todos os documentos necessários para realizar o exame.</p>
                    </div>
                    
                    <div class="field">
                        <label class="label">{{ form.pos_exame.label }}</label>
                        <div class="control">
                            {{ form.pos_exame(class="textarea", placeholder="Ex: Nenhuma restrição. Pode retomar atividades normais.", rows=3) }}
                        </div>
                        {% if form.pos_exame.errors %}
                            {% for error in form.pos_exame.errors %}
                                <p class="help is-danger">{{ error }}</p>
                            {% endfor %}
                        {% endif %}
                        <p class="help">Orientações sobre cuidados após a realização do exame.</p>
                    </div>
                    
                    <div class="field is-grouped">
                        <div class="control">
                            {{ form.submit(class="button is-primary") }}
                        </div>
                        <div class="control">
                            <a href="{{ url_for('admin_exames') }}" class="button is-light">Cancelar</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Help Section -->
        <div class="notification is-info is-light mt-4">
            <h4 class="title is-5">
                <span class="icon">
                    <i class="fas fa-lightbulb"></i>
                </span>
                <span>Dicas para um Bom Cadastro</span>
            </h4>
            <ul>
                <li><strong>Nome:</strong> Use nomes claros e reconhecíveis pelos pacientes</li>
                <li><strong>Descrição:</strong> Explique de forma simples o que o exame detecta</li>
                <li><strong>Preparo:</strong> Seja específico sobre jejum, medicamentos, etc.</li>
                <li><strong>Documentos:</strong> Liste todos os documentos necessários</li>
                <li><strong>Pós-exame:</strong> Informe sobre restrições ou cuidados especiais</li>
            </ul>
        </div>
        
        <!-- Preview Section -->
        <div class="card mt-4">
            <header class="card-header">
                <p class="card-header-title">
                    <span class="icon">
                        <i class="fas fa-eye"></i>
                    </span>
                    <span>Visualização do Exame</span>
                </p>
            </header>
            <div class="card-content">
                <div class="content">
                    <div class="columns">
                        <div class="column is-6">
                            <h5 class="title is-5">Como aparecerá no site:</h5>
                            <div class="box">
                                <h6 class="title is-6" id="preview-nome">Nome do Exame</h6>
                                <p class="is-size-7" id="preview-descricao">Descrição do exame...</p>
                                <span class="tag is-info is-light" id="preview-tempo">Duração</span>
                            </div>
                        </div>
                        <div class="column is-6">
                            <h5 class="title is-5">Informações completas:</h5>
                            <div class="box">
                                <p><strong>Preparo:</strong> <span id="preview-preparo">Instruções de preparo...</span></p>
                                <p><strong>Documentos:</strong> <span id="preview-documentos">Documentos necessários...</span></p>
                                <p><strong>Pós-exame:</strong> <span id="preview-pos-exame">Cuidados após o exame...</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Live preview functionality
document.addEventListener('DOMContentLoaded', function() {
    const nomeInput = document.getElementById('nome');
    const descricaoInput = document.getElementById('descricao');
    const tempoInput = document.getElementById('tempo');
    const preparoInput = document.getElementById('preparo');
    const documentosInput = document.getElementById('documentos');
    const posExameInput = document.getElementById('pos_exame');
    
    function updatePreview() {
        document.getElementById('preview-nome').textContent = nomeInput.value || 'Nome do Exame';
        document.getElementById('preview-descricao').textContent = descricaoInput.value || 'Descrição do exame...';
        document.getElementById('preview-tempo').textContent = tempoInput.value || 'Duração';
        document.getElementById('preview-preparo').textContent = preparoInput.value || 'Instruções de preparo...';
        document.getElementById('preview-documentos').textContent = documentosInput.value || 'Documentos necessários...';
        document.getElementById('preview-pos-exame').textContent = posExameInput.value || 'Cuidados após o exame...';
    }
    
    // Update preview on input
    [nomeInput, descricaoInput, tempoInput, preparoInput, documentosInput, posExameInput].forEach(input => {
        input.addEventListener('input', updatePreview);
    });
    
    // Initial preview
    updatePreview();
});
</script>
{% endblock %} 